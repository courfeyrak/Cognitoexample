openapi: 3.0.0
info:
  description: |
    Token champions Api Definition
  version: 1.0.0-oas3
  title: Token Champions
  termsOfService: http://tokenchampions.com/api/terms/
  contact:
    email: tokenchampionsapi@tokenchampions.com
  license:
    name: Token Champios all rigths reserved
    url: http://www.tokenchampions.com/licenses/LICENSE-2.0.html
servers:
  - description: DevEnv
    url: https://exbfyipti5.execute-api.us-east-1.amazonaws.com
tags:
  - name: TokenyQualifications
  - name: tokeny
    description: Tokeny integration
paths:
  /tokeny/users:
    post:
      tags:
        - tokeny
      summary: Create a new user in tokeny
      description: Create a new user in tokeny
      operationId: addTokenyUser
      security:
        - bearer_auth: []
      responses:
        '201':
          description: Success created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenyUser'
        '401':
          description: the user sent in the autorizarion does not have access
        '409':
          description: User already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenyError'
  /tokeny/users/qualifications/status:
    get:
      tags:
        - TokenyQualifications
      summary: gets the Tokeny estatus
      operationId: gettokenytatq
      security:
        - bearer_auth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenyQualification'
        '401':
          description: the user sent in the autorizarion does not have access
  /tokeny/users/qualifications/maindata:
    get:
      tags:
        - TokenyQualifications
      summary: Get identity Id created and wallet selected during Qualification process
      security:
        - bearer_auth: []
      responses:
        '206':
          description: Partial Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenyMainData'
  /tokeny/users/tat:
    get:
      tags:
        - tokeny
      summary: gets the Tokeny access token for the user
      operationId: gettokenytat
      security:
        - bearer_auth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenyUserTaT'
        '401':
          description: the user sent in the autorizarion does not have access
externalDocs:
  description: Find out more about Swagger
  url: http://swagger.io
components:
  schemas:
    TokenyQualification:
      type: object
      description: >-
        If status does not exists (304) or status = recorded or registered, this
        means investor has  never accessed qualification funnel or has not get
        to the final of the funnel -> redirect to Tokenchampions qualification
        funnel
      properties:
        allowedCountries:
          type: array
          items:
            type: string
        name:
          type: string
          description: always set to TokenyQualification
        languages:
          type: array
          items:
            type: string
        investorPortalUrl:
          type: string
        milestones:
          type: array
          items:
            type: string
        progress:
          type: integer
        investorStatus:
          type: string
          description: >-
            this means investor has got to the final of the funnel, so kyc check
            is pending to be triggered or investor has already been kyc checked
            -> proceed with the purchase flow (step 3).
          enum:
            - banned
            - recorded
            - registered
            - pending
            - approved
            - authorized
            - unauthorized
            - revoked
    TokenyMainData:
      type: object
      description: >-
        identity Id created and wallet selected during Qualification process
      properties:
        id: 
          type: string
        label: 
          type: string
        status: 
          type: string
        elements: 
          type: array
          items: 
            type: object
            properties: 
              fields: 
                type: array
                items: 
                  type: object
                  properties: 
                    id: 
                      type: string
                    type: 
                      type: string
                    label: 
                      type: string
                    value: 
                      type: string
                    helperText: 
                      type: string
                    required: 
                      type: boolean
                    standard: 
                      type: boolean
              id: 
                type: string
              layout: 
                type: string
              legend: 
                type: string
              type: 
                type: string
        warnOnUpdate: 
          type: boolean
        instructions: 
          type: string

        
    TokenyData:
      type: object
      properties:
        accountProviderId:
          type: string
        accountUserId:
          type: string
    TokenyError:
      type: object
      description: error message when a users already exists
      properties:
        error:
          type: string
        name:
          type: string
        data:
          $ref: '#/components/schemas/TokenyData'
    TokenyUserTaT:
      type: object
      properties:
        token:
          type: string
          description: tokeny access token
        issuedAt:
          type: integer
          description: Unix datetime
        expiresIn:
          type: integer
          description: Unix datetime
    TokenyUser:
      type: object
      properties:
        providerId:
          type: string
          description: Cognito id token
        sharedAccountId:
          type: string
          description: Cognito id token
        UserId:
          type: string
        email:
          type: string
    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
        type:
          type: string
        message:
          type: string
  requestBodies:
    TokenyUser:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TokenyUser'
      description: Pet object that needs to be added to the store
      required: true
    UserArray:
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/TokenyUser'
      description: List of user object
      required: true
  securitySchemes:
    bearer_auth:
      description: Aws id_token for the autenticated user.
      type: http
      scheme: bearer
      bearerFormat: JWT
